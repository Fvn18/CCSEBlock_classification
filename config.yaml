basic:
  dataset: "fer2013"
  device: "auto"
  num_workers: 8
  seed: 42
  use_amp: true

model:
  name: "extranet_scalable"
  scalable_model_scale: "pico"
  use_torch_compile: false

data:
  root: "./data/fer2013"
  train_path: "./data/fer2013/train"
  val_path: "./data/fer2013/val"
  test_path: "./data/fer2013/test"
  grayscale_output_channels: 1  

augmentation:
  use_tta: true
  tta_angles: [5.0, -5.0, 2.5, -2.5]
  resize_size: 64
  crop_size: 64
  horizontal_flip_prob: 0.5
  random_rotation_degrees: 10
  random_erasing_prob: 0.25
  color_jitter_prob: 0.0
  color_jitter_brightness: 0.3
  color_jitter_contrast: 0.2
  color_jitter_saturation: 0.2
  color_jitter_hue: 0.2
  random_affine_prob: 0.3
  gaussian_blur_prob: 0.1
  random_affine_translate: [0.1, 0.1]
  random_affine_scale: [0.9, 1.1]
  gaussian_blur_sigma: [0.1, 1.5]
  use_randaugment: false
  randaugment_n: 3
  randaugment_m: 10

training:
  batch_size: 128
  epochs: 400
  lr: 0.00055
  weight_decay: 0.0005
  patience: 105
  gradient_clip: 1.0

optimizer:
  name: "adamw"
  betas: [0.9, 0.999]
  momentum: 0.9

scheduler:
  name: "cosine"
  switch_to_plateau_epoch: 375
  use_warmup: true
  warmup_epochs: 15
  cosine_t_max: 350
  cosine_eta_min: 5.5e-07
  cosine_T_mult: 1.0
  step_size: 30
  gamma: 0.1
  plateau_patience: 4
  plateau_factor: 0.25

loss:
  type: "sce"
  sce_alpha: 1.0
  sce_beta: 0.1
  sce_ce_only_epochs: 10
  focal_gamma: 2.0
  gce_q: 0.7
  label_smoothing: 0.1
  dynamic_label_smoothing: false

strategies:
  mixup_alpha: 0.25
  mixup_prob: 0.32
  cutmix_alpha: 0.75
  cutmix_prob: 0.4
  use_class_weights: false
  class_weights: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

logging:
  save_checkpoints: false
  save_freq: 10
  log_freq: 2
  save_best_only: true

normalization:
  mean: [0.5,]
  std: [0.5,]
